[build]
  command = "npm run build && npm run build:storybook"
  publish = "dist"
  functions = "netlify/functions"

[functions]
  included_files = [
    "src/content/**",
    "node_modules/mdx-bundler/**",
    "node_modules/@mdx-js/**",
    "node_modules/rehype*/**",
    "node_modules/esbuild/**"
  ]
  external_node_modules = [
    "esbuild", 
    "rehype-highlight", 
    "rehype-mdx-import-media",
    "@mdx-js/react",
    "mdx-bundler"
  ]

[[redirects]]
  from = "/storybook/*"
  to = "/storybook/:splat"
  status = 200
  force = true

[[redirects]]
  from = "/storybook"
  to = "/storybook/index.html"
  status = 200
  force = true

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200